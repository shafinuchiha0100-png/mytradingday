<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SHAFIN UCHIHA TRADER</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: 'Arial', sans-serif; margin: 0; padding: 0; background: #e6f2ff; }
    header { background: #1e90ff; color: #fff; padding: 15px; text-align: center; font-size: 22px; font-weight: bold; }
    nav { display: flex; flex-wrap: wrap; background: #3399ff; }
    nav button { flex: 1; padding: 12px; background: #3399ff; color: #fff; border: none; cursor: pointer; font-size: 14px; }
    nav button:hover, nav button.active { background: #1e90ff; }
    section { display: none; padding: 15px; }
    section.active { display: block; }
    .card { background: white; padding: 15px; margin-bottom: 12px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    input, textarea, select { width: 100%; padding: 8px; margin: 6px 0; border: 1px solid #ccc; border-radius: 4px; }
    button.action { padding: 8px 15px; margin-top: 8px; cursor: pointer; background: #1e90ff; color: #fff; border: none; border-radius: 4px; }
    button.delete { background: #d9534f; }
    img.pattern-img { max-width: 100%; margin-top: 8px; border-radius: 4px; }
    /* Calculator */
    .calc-container { max-width: 320px; margin: auto; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.2); }
    .calc-display { width: 100%; padding: 10px; margin-bottom: 10px; font-size: 20px; text-align: right; border: 1px solid #ccc; border-radius: 4px; }
    .calc-buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
    .calc-buttons button { padding: 15px; font-size: 18px; background: #1e90ff; color: #fff; border: none; border-radius: 6px; cursor: pointer; }
    .calc-buttons button:hover { background: #005fcb; }
    .calc-buttons .clear { background: #d9534f; }
  </style>
</head>
<body>
  <header>SHAFIN UCHIHA TRADER</header>
  <nav>
    <button onclick="showTab('lot')" class="active">Lot Calc</button>
    <button onclick="showTab('patterns')">Patterns</button>
    <button onclick="showTab('candles')">Candles</button>
    <button onclick="showTab('strategies')">Strategies</button>
    <button onclick="showTab('history')">History</button>
    <button onclick="showTab('calculator')">Calculator</button>
  </nav>

  <!-- Lot Calculator -->
  <section id="lot" class="active">
    <h2>Lot Size Calculator</h2>
    <div class="card">
      <label>Account Balance ($)</label>
      <input type="number" id="balance">
      <label>Risk %</label>
      <input type="number" id="risk">
      <label>Stop Loss (pips)</label>
      <input type="number" id="sl">
      <label>Pip Value per 1 Lot ($)</label>
      <input type="number" id="pipValue" value="10">
      <button class="action" onclick="calcLot()">Calculate</button>
      <p id="lotResult"></p>
    </div>
  </section>

  <!-- Chart Patterns -->
  <section id="patterns">
    <h2>Chart Patterns</h2>
    <div class="card">
      <input type="text" id="patternName" placeholder="Pattern Name">
      <textarea id="patternDesc" placeholder="Description"></textarea>
      <input type="file" id="patternImg">
      <button class="action" onclick="savePattern()">Save Pattern</button>
    </div>
    <div id="patternList"></div>
  </section>

  <!-- Candlestick Patterns -->
  <section id="candles">
    <h2>Candlestick Patterns</h2>
    <div class="card">
      <input type="text" id="candleName" placeholder="Pattern Name">
      <textarea id="candleDesc" placeholder="Description"></textarea>
      <input type="file" id="candleImg">
      <button class="action" onclick="saveCandle()">Save Candle</button>
    </div>
    <div id="candleList"></div>
  </section>

  <!-- Strategies -->
  <section id="strategies">
    <h2>My Strategies</h2>
    <div class="card">
      <textarea id="strategyText" placeholder="Write your strategy..."></textarea>
      <input type="file" id="strategyImg">
      <button class="action" onclick="saveStrategy()">Save Strategy</button>
    </div>
    <div id="strategyList"></div>
  </section>

  <!-- Trade History -->
  <section id="history">
    <h2>Trade History</h2>
    <div class="card">
      <input type="text" id="pair" placeholder="Pair">
      <input type="number" id="lotInput" placeholder="Lot Size">
      <input type="number" id="pl" placeholder="Profit/Loss ($)">
      <input type="file" id="tradeImg">
      <button class="action" onclick="saveTrade()">Save Trade</button>
    </div>
    <div id="tradeList"></div>
  </section>

  <!-- Calculator -->
  <section id="calculator">
    <h2>Calculator</h2>
    <div class="calc-container">
      <input type="text" id="calcDisplay" class="calc-display" readonly>
      <div class="calc-buttons">
        <button onclick="calcPress('7')">7</button>
        <button onclick="calcPress('8')">8</button>
        <button onclick="calcPress('9')">9</button>
        <button onclick="calcPress('/')">÷</button>
        <button onclick="calcPress('4')">4</button>
        <button onclick="calcPress('5')">5</button>
        <button onclick="calcPress('6')">6</button>
        <button onclick="calcPress('*')">×</button>
        <button onclick="calcPress('1')">1</button>
        <button onclick="calcPress('2')">2</button>
        <button onclick="calcPress('3')">3</button>
        <button onclick="calcPress('-')">−</button>
        <button onclick="calcPress('0')">0</button>
        <button onclick="calcPress('.')">.</button>
        <button onclick="calculate()">=</button>
        <button onclick="calcPress('+')">+</button>
        <button class="clear" style="grid-column: span 4;" onclick="clearCalc()">Clear</button>
      </div>
    </div>
  </section>

<script>
  // Tabs
  function showTab(tab) {
    document.querySelectorAll('section').forEach(s => s.classList.remove('active'));
    document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
    event.target.classList.add('active');
  }

  // Lot Size Calculator
  function calcLot() {
    let bal = parseFloat(document.getElementById('balance').value);
    let risk = parseFloat(document.getElementById('risk').value);
    let sl = parseFloat(document.getElementById('sl').value);
    let pipVal = parseFloat(document.getElementById('pipValue').value);
    if (bal && risk && sl && pipVal) {
      let riskAmount = bal * (risk/100);
      let lotSize = riskAmount / (sl * pipVal);
      document.getElementById('lotResult').innerText = "Lot Size: " + lotSize.toFixed(2);
    } else {
      document.getElementById('lotResult').innerText = "Please fill all fields.";
    }
  }

  // ================= Local Storage Functions =================

  // ======= Chart Patterns =======
  function savePattern() {
    let name = document.getElementById('patternName').value;
    let desc = document.getElementById('patternDesc').value;
    let imgFile = document.getElementById('patternImg').files[0];
    if (!name) return;

    let reader = new FileReader();
    reader.onload = function(e) {
      let pattern = {name:name, desc:desc, img:e.target.result};
      let patterns = JSON.parse(localStorage.getItem('patterns') || '[]');
      patterns.push(pattern);
      localStorage.setItem('patterns', JSON.stringify(patterns));
      displayPatterns();
    }
    if(imgFile) reader.readAsDataURL(imgFile);
  }

  function displayPatterns() {
    let patternList = document.getElementById('patternList');
    patternList.innerHTML = '';
    let patterns = JSON.parse(localStorage.getItem('patterns') || '[]');
    patterns.forEach((p, i) => {
      let div = document.createElement('div');
      div.className='card';
      div.innerHTML = `<h3>${p.name}</h3><p>${p.desc}</p><img src="${p.img}" class="pattern-img"><br>
                       <button class='delete' onclick='deletePattern(${i})'>Delete</button>`;
      patternList.appendChild(div);
    });
  }

  function deletePattern(index){
    let patterns = JSON.parse(localStorage.getItem('patterns') || '[]');
    patterns.splice(index,1);
    localStorage.setItem('patterns', JSON.stringify(patterns));
    displayPatterns();
  }

  // ======= Candles =======
  function saveCandle() {
    let name = document.getElementById('candleName').value;
    let desc = document.getElementById('candleDesc').value;
    let imgFile = document.getElementById('candleImg').files[0];
    if (!name) return;

    let reader = new FileReader();
    reader.onload = function(e) {
      let candle = {name:name, desc:desc, img:e.target.result};
      let candles = JSON.parse(localStorage.getItem('candles') || '[]');
      candles.push(candle);
      localStorage.setItem('candles', JSON.stringify(candles));
      displayCandles();
    }
    if(imgFile) reader.readAsDataURL(imgFile);
  }

  function displayCandles() {
    let candleList = document.getElementById('candleList');
    candleList.innerHTML = '';
    let candles = JSON.parse(localStorage.getItem('candles') || '[]');
    candles.forEach((c,i)=>{
      let div=document.createElement('div');
      div.className='card';
      div.innerHTML=`<h3>${c.name}</h3><p>${c.desc}</p><img src="${c.img}" class="pattern-img"><br>
                     <button class='delete' onclick='deleteCandle(${i})'>Delete</button>`;
      candleList.appendChild(div);
    });
  }

  function deleteCandle(index){
    let candles=JSON.parse(localStorage.getItem('candles')||'[]');
    candles.splice(index,1);
    localStorage.setItem('candles',JSON.stringify(candles));
    displayCandles();
  }

  // ======= Strategies =======
  function saveStrategy() {
    let text = document.getElementById('strategyText').value;
    let imgFile = document.getElementById('strategyImg').files[0];
    if (!text && !imgFile) return;

    let strategy = {text:text, img:null};

    if(imgFile){
      let reader = new FileReader();
      reader.onload=function(e){
        strategy.img=e.target.result;
        storeStrategy(strategy);
      }
      reader.readAsDataURL(imgFile);
    }else{
      storeStrategy(strategy);
    }
  }

  function storeStrategy(strategy){
    let strategies=JSON.parse(localStorage.getItem('strategies')||'[]');
    strategies.push(strategy);
    localStorage.setItem('strategies',JSON.stringify(strategies));
    displayStrategies();
  }

  function displayStrategies(){
    let strategyList=document.getElementById('strategyList');
    strategyList.innerHTML='';
    let strategies=JSON.parse(localStorage.getItem('strategies')||'[]');
    strategies.forEach((s,i)=>{
      let div=document.createElement('div');
      div.className='card';
      div.innerHTML=`<p>${s.text}</p>${s.img?`<img src="${s.img}" class="pattern-img">`:''}<br>
                     <button class='delete' onclick='deleteStrategy(${i})'>Delete</button>`;
      strategyList.appendChild(div);
    });
  }

  function deleteStrategy(index){
    let strategies=JSON.parse(localStorage.getItem('strategies')||'[]');
    strategies.splice(index,1);
    localStorage.setItem('strategies',JSON.stringify(strategies));
    displayStrategies();
  }

  // ======= Trade History =======
  function saveTrade() {
    let pair=document.getElementById('pair').value;
    let lot=document.getElementById('lotInput').value;
    let pl=document.getElementById('pl').value;
    let imgFile=document.getElementById('tradeImg').files[0];
    if(!pair || !lot || !pl) return;

    let trade={pair:pair, lot:lot, pl:pl, img:null};

    if(imgFile){
      let reader=new FileReader();
      reader.onload=function(e){
        trade.img=e.target.result;
        storeTrade(trade);
      }
      reader.readAsDataURL(imgFile);
    }else{
      storeTrade(trade);
    }
  }

  function storeTrade(trade){
    let trades=JSON.parse(localStorage.getItem('trades')||'[]');
    trades.push(trade);
    localStorage.setItem('trades',JSON.stringify(trades));
    displayTrades();
  }

  function displayTrades(){
    let tradeList=document.getElementById('tradeList');
    tradeList.innerHTML='';
    let trades=JSON.parse(localStorage.getItem('trades')||'[]');
    trades.forEach((t,i)=>{
      let div=document.createElement('div');
      div.className='card';
      div.innerHTML=`<h3>${t.pair}</h3><p>Lot: ${t.lot}</p><p>P/L: $${t.pl}</p>${t.img?`<img src="${t.img}" class="pattern-img">`:''}<br>
                     <button class='delete' onclick='deleteTrade(${i})'>Delete</button>`;
      tradeList.appendChild(div);
    });
  }

  function deleteTrade(index){
    let trades=JSON.parse(localStorage.getItem('trades')||'[]');
    trades.splice(index,1);
    localStorage.setItem('trades',JSON.stringify(trades));
    displayTrades();
  }

  // ======= Calculator =======
  function calcPress(val){document.getElementById('calcDisplay').value+=val;}
  function clearCalc(){document.getElementById('calcDisplay').value='';}
  function calculate(){try{document.getElementById('calcDisplay').value=eval(document.getElementById('calcDisplay').value);}catch{document.getElementById('calcDisplay').value='Error';}}

  // ======= Load data on page load =======
  window.onload=function(){
    displayPatterns();
    displayCandles();
    displayStrategies();
    displayTrades();
  }
</script>
</body>
          </html>
